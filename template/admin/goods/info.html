<form method="post" class="form-x admin-form form-auto" id="form">
    <div class="tab admin-tab">
        <div class="panel admin-box active">
            <div class="panel-head">
                <div class="tab-head">
                    <strong>产品信息</strong>
                    <ul class="tab-nav">
                        <li class="active"><a href="#tab-1">基本信息</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="tab-body">
                <div class="tab-panel active" id="tab-1">
                	{include file="common/factory" /}
                    <div class="form-group js-select" posturl="{:url('Gcate/getAjaxList', ['store_id' => ($info && $info['store_id'] ? $info['store_id']: $store_id)])}" str="选择产品分类" searchName="请输入分类名称" formname="cate_id" formvalue='{$info.cate_id ?? 0}'></div>
                    <div class="form-group">
                        <div class="label">
                            <label>产品名称</label>
                        </div>
                        <div class="field">
                            <input type="text" class="input" id="name" name="name" size="40" datatype="*" value="{$info['name'] ?? ''}">
                            <div class="input-note">产品名称请不要填写特殊字符</div>
                        </div>
                    </div>
                    <div class="form-group">
						<div class="label">
							<label>产品类型</label>
						</div>
						<div class="field">
							<select class="input" name="goods_type" id="goods_type" datatype="n"nullmsg="请选择产品类型！">
								{foreach name="goodsTypes" item="goodsType" key="key"}
									<option value="{$key}" {if condition="!$info || ($key && isset($info['goods_type']) && $info['goods_type'] == $key)" }selected="selected"{/if} >{$goodsType}</option> 
								{/foreach}
							</select>
							<div class="input-note">请选择产品类型</div>
						</div>
					</div>
                    <div class="form-group">
		                <div class="label">
		                  <label>上传图片</label>
		                </div>
		                <div class="field"> <a class="button bg-main button-small js-multi-upload" data="imgs" id="image_upload" href="javascript:;" ><span class="icon-upload"> 批量上传</span></a>
		                  <div class="input-note note">请上传不大于2M的图片,支持多图上传</div>
		                </div>
		              </div>
		              <div class="imagesBox form-group clearfix" id="imgs">
		              	{if condition="$info && isset($info['imgs'])"}
		                  {volist name="info.imgs" id="vo" mod="10"}
		                	<div class="media radius clearfix">
		                      <a class="media-del icon-close" href="javascript:;" title="点击移除本图"></a>
		                      {eq name="mod" value="0"}
		                      <span>我是封面</span>
		                      {else /}
		                      <span class="uptofirst">设为封面</span>
		                      {/eq}
		                      <img src="{$vo ?? ''}" >
		                      <div class="media-body">
		                      <input name="imgs[]" type="hidden" class="input" value="{$vo ?? ''}" />
		                      </div>
		                  </div>
		                  {/volist}
		                  {/if}
		              </div>
		              <div class="form-group">
		                  <div class="label">
		                    <label>封面图片</label>
		                  </div>
		                  <div class="field">
		                    <div class="image_preview" style="margin-bottom:10px;">
		                    <input name="thumb" type="hidden" class="input title_img" value="{$info['thumb'] ?? ''}" />
		                    <img src="{$info.thumb|default='/static/base/images/default.png'}" id="preview_imgs" width="120"></div>
		                  </div>
	                </div> 
	                <div class="form-group">
                        <div class="label">
                            <label>产品货号</label>
                        </div>
                        <div class="field">
                            <input type="text" class="input" id="goods_sn" name="goods_sn" size="40" value="{$info['goods_sn'] ?? ''}">
                            <div class="input-note">产品货号请不要填写特殊字符</div>
                        </div>
                    </div>
	                <div class="form-group">
		                <div class="label">
		                  <label>产品价格</label>
		                </div>
		                <div class="field">
		                  <input type="text" class="input" id="min_price" name="min_price" size="12" value="{$info.min_price|default=0.00}" nullmsg="请填写产品价格！"> 元
		                  <div class="input-note"></div>
		                </div>
		              </div>
		              <div class="form-group">
		                <div class="label">
		                  <label>产品库存</label>
		                </div>
		                <div class="field">
		                  <input type="text" class="input" id="goods_stock" name="goods_stock" size="12" value="{$info.goods_stock|default=0}" nullmsg="请填写产品库存！" {if condition="$info && isset($info['skuinfo']) && $info['skuinfo']"}disabled="disabled"{/if}>
		                  <div class="input-note"></div>
		                </div>
		              </div>
	                <div class="form-group">
			            <div class="label">
			              <label>产品描述</label>
			            </div>
			            <div class="field">
			              <textarea class="input" id="description" name="description" rows="5" cols="60">{$info['description'] ?? ''}</textarea>
			              <div class="input-note"></div>
			            </div>
			          </div>
			          <div class="form-group">
		                <div class="label">
		                  <label>产品详情</label>
		                </div>
		                <div class="field">
		                  <textarea class="input js-editor" id="content" name="content" rows="20">
		                  	{$info.content? stripslashes($info.content) : '' }
		                  </textarea>
		                  <div class="input-note">请输入产品详情</div>
		                </div>
		              </div>
                    <div id="expand"></div>
                    <div class="form-group">
                        <div class="label">
                            <label>是否下架</label>
                        </div>
                        <div class="field">
                           {notpresent name="info.status"}
                                {assign name="info.status" value="1" /}
                           {/notpresent}
                            <div class="button-group radio">
                                {if condition="$info.status eq 1"}
                                <label class="button active"><input name="status" value="1" checked="checked" type="radio">
                                {else /}
                                <label class="button"><input name="status" value="1" type="radio">
                                {/if}否</label>
                                {if condition="$info.status eq 0"}
                                <label class="button active"><input name="status" value="0" checked="checked" type="radio">
                                {else /}
                                <label class="button"><input name="status" value="0" type="radio">
                                {/if}是</label>
                            </div>
                            <div class="input-note">下架后不在前台显示</div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="label">
                            <label>排序</label>
                        </div>
                        <div class="field">
                            <input type="number" class="input" id="sort_order" name="sort_order" size="60" value="{$info.sort_order|default=1}">
                            <div class="input-note">开启自定义排序有效</div>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="panel-foot">
                <div class="form-button">
                    <button class="button bg-main" type="submit">保存</button>
                    <button class="button bg" type="reset">重置</button>
                    <div id="tips"></div>
                </div>
            </div>
        </div>
    </div>
</form>
<script>
	var Config = {
		'editorUploadUrl' : "{:url('admin/Upload/editorupload', ['prex' => 'goods_'])}",
	};
    Do.ready('base', function () {
        //表单综合处理
        $('#form').FormPage({
        	'uploadUrl' : "{:url('admin/Upload/upload', ['prex' => 'goods_', 'thumb_type' => 'goods_thumb'])}",
            {present name="info['goods_id']"}
            cookie: 'editgoods{$info.goods_id}',
            num: {$info.imgnum}
            {else /}
            cookie: 'goodsUpload',
            {/present}
          });  
        $('#store_id').change(function(){
			var id = $(this).val();
			if(id > 0){
				$("#cate_id").val(0);
				$(".js-select").selectsin({
					'str' 		: '选择产品分类',
					'searchName': '请输入分类名称',
					'name' 		: 'cate_id',
					'id' 		: '{$store_id}',
					'postUrl' 	: "/Gcate/getAjaxList/store_id/"+id,
				});
			}else{
				$('.js-select').hide();
			}
		});
    }); 
</script>