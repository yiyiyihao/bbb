<form method="post" class="form-x admin-form form-auto" id="form">
    <div class="tab admin-tab">
        <div class="panel admin-box active">
            <div class="panel-head">
                <div class="tab-head">
                    <strong>分类信息</strong>
                    <ul class="tab-nav">
                        <li class="active"><a href="#tab-1">基本信息</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="tab-body">
                <div class="tab-panel active" id="tab-1">
                	{include file="common/factory" /}
                    <div class="form-group js-select" posturl="{:url('Gcate/getAjaxList', ['neq' => ($info ? $info['cate_id'] : 0), 'factory_id' => $info && $info['factory_id'] ? $info['factory_id']: $factory_id])}" str="选择上级分类" searchName="请输入分类名称" formname="parent_id" formvalue='{$info.parent_id ?? 0}'></div>
                    <!-- <div class="form-group">
                        <div class="label">
                            <label>上级分类</label>
                        </div>
                        <div class="field">
                            <select class="input" name="parent_id" id="parent_id" nullmsg="请选择上级分类！">
                              <option value="">==请选择上级分类==</option>
                               {foreach name="cates" item="vo"}
                               <option value="{$vo.cate_id}" 
                               {if condition="isset($vo['cate_id']) && isset($info['parent_id']) && $info['parent_id'] == $vo['cate_id']"}selected="selected"{/if} >{$vo.cname}</option>
                               {/foreach}
                            </select>
                            <div class="input-note">请选择上级分类</div>
                        </div>
                    </div> -->
                    <div class="form-group">
                        <div class="label">
                            <label>分类名称</label>
                        </div>
                        <div class="field">
                            <input type="text" class="input" id="name" name="name" size="40" datatype="*" value="{$info['name'] ?? ''}">
                            <div class="input-note">分类名称请不要填写特殊字符</div>
                        </div>
                    </div>
                    <div id="expand"></div>
                    <div class="form-group">
                        <div class="label">
                            <label>显示状态</label>
                        </div>
                        <div class="field">
                           {notpresent name="info.status"}
                                {assign name="info.status" value="1" /}
                           {/notpresent}
                            <div class="button-group radio">
                                {if condition="$info.status eq 1"}
                                <label class="button active"><input name="status" value="1" checked="checked" type="radio">
                                {else /}
                                <label class="button"><input name="status" value="1" type="radio">
                                {/if}
                                可用</label>
                                {if condition="$info.status eq 0"}
                                <label class="button active"><input name="status" value="0" checked="checked" type="radio">
                                {else /}
                                <label class="button"><input name="status" value="0" type="radio">
                                {/if}
                                禁用</label>
                            </div>
                            <div class="input-note">禁用后不会在前台显示</div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="label">
                            <label>排序</label>
                        </div>
                        <div class="field">
                            <input type="number" class="input" id="sort_order" name="sort_order" size="60" value="{$info.sort_order|default=1}">
                            <div class="input-note">开启自定义排序有效</div>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="panel-foot">
                <div class="form-button">
                    <div id="tips"></div>
                    <button class="button bg-main" type="submit">保存</button>
                    <button class="button bg" type="reset">重置</button>
                </div>
            </div>
        </div>
    </div>
</form>
<script>
    Do.ready('base', function () {
        //表单综合处理
        $('#form').FormPage();
        $('#factory_id').change(function(){
			var id = $(this).val();
			if(id > 0){
				$(".js-select").selectsin({
					'str' 		: '选择上级分类',
					'searchName': '请输入分类名称',
					'name' 		: 'parent_id',
					'id' 		: '{$factory_id}',
					'postUrl' 	: "/Gcate/getAjaxList/factory_id/"+id+"/neq/{$info['cate_id'] ?? 0}",
				});
			}else{
				$('.js-select').hide();
			}
		});
    }); 
</script>